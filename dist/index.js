class WebsocketConnection{constructor(o,e){this.host=o,this.log=e,this.onOpen=(()=>{}),this.onClose=(()=>{}),this.onError=(o=>{}),this.onMessage=(o=>{}),this.readyState=0}connect(){this.readyState=0;const o=new WebSocket(this.host);return o.binaryType="arraybuffer",o.onopen=(()=>this._onOpen()),o.onclose=(()=>this._onClose()),o.onerror=(o=>this._onError(o)),o.onmessage=(o=>this._onMessage(o)),this.connection=o}close(){return this.connection.close()}send(o){if(o instanceof Uint8Array||o instanceof Blob)return this.connection.send(o);console.error("Payload to send() must be Uint8Array or blob")}_onMessage(o){this.onMessage(o.data)}_onOpen(o){this.log.log("flux: opened"),this.readyState=1,this.onOpen(),this.log.log("flux: after opened")}_onClose(o){this.log.log("flux: closed"),this.readyState=2,this.onClose()}_onError(o){null!=this.log&&this.log.log("flux: we have a error:",o),this.onError(o)}}export{WebsocketConnection};